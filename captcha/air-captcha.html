<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mouse Movement CAPTCHA</title>
    <style>
        #verify-btn {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <button id="verify-btn">Verify</button>
    <script>
        const verifyBtn = document.getElementById('verify-btn');
        let mouseMovements = [];
        let isTouchDevice = 'ontouchstart' in document.documentElement;

        function recordMouseMovement(event) {
            const position = { x: event.clientX, y: event.clientY, time: Date.now() };
            mouseMovements.push(position);
        }

        function calculateSpeed(movements) {
            let totalSpeed = 0;
            for (let i = 1; i < movements.length; i++) {
                const dx = movements[i].x - movements[i - 1].x;
                const dy = movements[i].y - movements[i - 1].y;
                const dt = movements[i].time - movements[i - 1].time;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const speed = distance / dt;
                totalSpeed += speed;
            }
            return totalSpeed / (movements.length - 1);
        }

        function isValidMovement(movements) {
            if (movements.length < 5) return false;

            const averageSpeed = calculateSpeed(movements);
            let deviations = 0;
            for (let i = 1; i < movements.length; i++) {
                const dx = movements[i].x - movements[i - 1].x;
                const dy = movements[i].y - movements[i - 1].y;
                const dt = movements[i].time - movements[i - 1].time;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const speed = distance / dt;
                if (Math.abs(speed - averageSpeed) > averageSpeed * 0.5) {
                    deviations++;
                }
            }
            return deviations > (movements.length * 0.3);
        }

        document.addEventListener('mousemove', recordMouseMovement);

        verifyBtn.addEventListener('click', () => {
            if (isTouchDevice) {
                setTimeout(() => {
                    alert('Verification Passed (Touch Device)');
                }, 1000);
            } else {
                if (isValidMovement(mouseMovements)) {
                    alert('Verification Passed');
                } else {
                    alert('Verification Failed');
                }
            }
        });
    </script>
</body>
</html>
